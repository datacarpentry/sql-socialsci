<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Management with SQL for Social Scientists *alpha*: Creating New Columns</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav data"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="dc-logo" alt="Data Carpentry" src="assets/images/data-logo.svg"><span class="badge text-bg-warning">
          <abbr title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alpha
            </a>
            <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
          </abbr>
        </span>
        
      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>
      
      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/05-creating-new-columns.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Management with SQL for Social Scientists *alpha*
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Management with SQL for Social Scientists *alpha*
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Management with SQL for Social Scientists *alpha*
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 29%" class="percentage">
    29%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 29%" aria-valuenow="29" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/05-creating-new-columns.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-relational-database.html">1. What is a relational database?</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-db-browser.html">2. Using DB Browser for SQLite</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-select.html">3. The Select Statement</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-missing-data.html">4. Missing Data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Creating New Columns
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#creating-new-columns">Creating new columns</a></li>
<li><a href="#renaming-columns-using-aliases">Renaming columns using aliases</a></li>
<li><a href="#using-built-in-functions-to-create-new-values">Using built-in functions to create new values</a></li>
<li><a href="#using-sql-syntax-to-conditionally-create-new-values">Using SQL syntax to conditionally create new values</a></li>
<li><a href="#using-sql-syntax-to-create-binned-values">Using SQL syntax to create ‘binned’ values</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-aggregation.html">6. Aggregations</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-creating-tables-views.html">7. Creating tables and views</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-sqlite-command-line.html">8. The SQLite command line</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-joins.html">9. Joins</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-other-environments.html">10. Using database tables in other environments</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-missing-data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-aggregation.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-missing-data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Missing Data
        </a>
        <a class="chapter-link float-end" href="06-aggregation.html" rel="next">
          Next: Aggregations... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Creating New Columns</h1>
        <p>Last updated on 2023-05-02 |
        
        <a href="https://github.com/datacarpentry/sql-socialsci/edit/main/episodes/05-creating-new-columns.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I add new columns with derived values in the query
results?</li>
<li>How can I give a column a new name?</li>
<li>How do I use built-in functions to create new values?</li>
<li>How can I create binned results?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Create new columns in the query output</li>
<li>Rename columns in the query output</li>
<li>Use built-in functions to create new values</li>
<li>Use SQL syntax to conditionally create new values</li>
<li>Use SQL syntax to create a new column of ‘binned’ values</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="creating-new-columns"><h2 class="section-heading">Creating new columns<a class="anchor" aria-label="anchor" href="#creating-new-columns"></a>
</h2>
<hr class="half-width"><p>In addition to selecting existing columns from a table, you can also
create new columns in the query output based on the existing columns.
These new columns only exist in the output. The table used in the query
is not changed in any way.</p>
<p>The Plots table contains a column, <code>D02_total_plot</code>
representing the area of the plot and the <code>D03_unit_land</code>
column gives the units. In our sample dataset the unit is always
‘hectare’. However in the full dataset some of the plot areas are
recorded in ‘acres’. We want to create a new output column which shows
the hectare value converted into acres. To do this we could use the
following SQL. ( 1 hectare = 2.4701 acres)</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">SELECT</span> D02_total_plot <span class="op">*</span> <span class="fl">2.4701</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="kw">FROM</span> Plots</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>;</span></code></pre>
</div>
<p>Running this query will give the correct answers, but it uses the
expression used in creating the new column as the column name. This
looks very messy, especially if the expression is long. It is always the
case that if you create a column in the results of the query it won’t
have a name by default. SQL will create one for it. Other relational
databases take different approaches to the problem and will
pseudo-randomly name the new columns for you with such things as ‘_c0’.
SQLite uses the expression you used to create the column name.</p>
</section><section id="renaming-columns-using-aliases"><h2 class="section-heading">Renaming columns using aliases<a class="anchor" aria-label="anchor" href="#renaming-columns-using-aliases"></a>
</h2>
<hr class="half-width"><p>Given that creating new columns is so commonly done, SQL does provide
a mechanism for giving them names of your choice. This is done using the
<strong>AS</strong> clause</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="kw">SELECT</span> D02_total_plot <span class="op">*</span> <span class="fl">2.4701</span> <span class="kw">AS</span> D02_total_plot_converted</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="kw">FROM</span> Plots</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>;</span></code></pre>
</div>
<p>The <strong>AS</strong> keyword itself is optional. You can just put
the name of the new column, but using the <strong>AS</strong> keyword
adds clarity. Creating column names in this way is referred to as adding
an alias. This may seem a bit strange for columns which had no real name
in the first place, but the point is, you can give any table column name
an alias to be used in the output rather than the original.</p>
</section><section id="using-built-in-functions-to-create-new-values"><h2 class="section-heading">Using built-in functions to create new values<a class="anchor" aria-label="anchor" href="#using-built-in-functions-to-create-new-values"></a>
</h2>
<hr class="half-width"><p>In addition to using simple arithmetic operations to create new
columns, you can also use some of the SQLite built-in functions. Full
details of the available built-in functions are available from the
SQLite.org website <a href="https://sqlite.org/lang_corefunc.html#instr" class="external-link">here</a>.</p>
<p>We will look at some of the arithmetic and statistical functions when
we deal with aggregations in a later lesson.</p>
<p>You may have noticed in the output from are last query that the
number of decimal places can change from one row to another. In order to
make the output more tidy, we may wish to always produce the same number
of decimal places, e.g. 2. We can do this using the <code>ROUND</code>
function.</p>
<p>The <code>ROUND</code> function works in a similar way as its
spreadsheet equivalent, you specify the value you wish to round and the
required number of decimal places.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">ROUND</span>(D02_total_plot <span class="op">*</span> <span class="fl">2.4701</span>, <span class="dv">2</span>) <span class="kw">as</span> D02_total_plot_converted</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="kw">FROM</span> Plots</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>;</span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Write an SQL query which returns the Id, plot_Id, D01_curr_plot and
D02_total_plot columns from the Plots table with the addition of a
calculated column representing the plot area in acres and a column
representing the units of the calculated column.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">Id</span>, plot_Id, D01_curr_plot, D02_total_plot,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>       <span class="fu">ROUND</span>(D02_total_plot <span class="op">*</span> <span class="fl">2.4701</span>, <span class="dv">2</span>) <span class="kw">AS</span> D02_total_plot_converted,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>       <span class="st">'acres'</span> <span class="kw">AS</span> D03_unit_land_converted</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="kw">FROM</span> Plots</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>;</span></code></pre>
</div>
<p>Notice that we can use columns as part of the calculated column which
are not returned in the output. Also our second new column doesn’t
actually need to make use of any of the other columns, it can just be a
value.</p>
</div>
</div>
</div>
</div>
<p>We will now look at a couple of the more common text functions. These
have equivalents in other programming languages or spreadsheet systems,
sometimes with different names.</p>
<table class="table"><thead><tr class="header"><th>SQLite function</th>
<th align="left">Excel equivalent</th>
</tr></thead><tbody><tr class="odd"><td>substr(a,b,c)</td>
<td align="left">mid(a,b,c)</td>
</tr><tr class="even"><td>instr(a,b)</td>
<td align="left">find(a,b)</td>
</tr></tbody></table><p><code>instr</code> can be used to check a character or string of
characters occurs within another string. <code>substr</code> can be used
to extract a portion of a string based on a starting position and the
number of characters required.</p>
<p>In the Farms table, the three columns A01_interview_date, A04_start
and A05_end are all recognisable as a dates with the A04_start and
A05_end also including times. These last two are automatically generated
by the eSurvey software when the data is collected, i.e. they are
automatically entered. The A01_interview_date however is manually input.
In all three cases however SQLite thinks that they are all just strings
of characters. We can confirm this by selecting the
<code>Database Structure</code> tab and expanding the <code>Farms</code>
entry and notice that the data type for all three columns is listed as
‘TEXT’</p>
<p>To see what these columns look like you can run the following
query;</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date, A04_start, A05_end</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>;</span></code></pre>
</div>
<p>The format of the A04_start and A05_end columns follow the <a href="https://en.wikipedia.org/wiki/ISO_8601" class="external-link">ISO 8601</a>. The
A01_interview_date column on the other hand uses the shorthand
dd/mm/yyyy format.</p>
<p>The drawback of having dates represented by strings occurs when you
want to sort them. In SQL you can sort the output of your query by using
an <code>ORDER BY</code> clause at the end of the select statement.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> A01_interview_date</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>;</span></code></pre>
</div>
<p>NB. we are using the UK and European representation of dates in this
discussion. The same issue will occur if you were using US date
formats.</p>
<p>It is unlikely that the result of the above query is what you wanted.
‘01/07/2017’ has been ordered before ‘01/12/2016’. This is because the
sorting process treats the dates as simple strings and a ‘0’ in the
month position is less than a ‘1’ in the months position.</p>
<p>In order to sort the A01_interview_date column into date order we
need to make SQLite see it as a date. SQLite does have a date function.
Unfortunately by itself, it won’t work on A01_interview_date.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date, </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>       <span class="dt">date</span>(A01_interview_date) <span class="kw">AS</span> converted_A01,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>       A04_start,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>       <span class="dt">date</span>(A04_start) <span class="kw">AS</span> coverted_A04</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>;</span></code></pre>
</div>
<p>Although it doesn’t produce an error, the attempted conversion of
A01_interview_date into a date format has failed. A set of NULLs was
returned.</p>
<figure><img src="fig/SQL_05_dates_01.png" alt="Conversion failure" class="figure mx-auto d-block"></figure><p>On the other hand the A04_start conversion did work. The problem is
that the date function expects the string to be converted to be in a
certain format like ISO-8601.</p>
<p>We need to change the way A01_interview_date looks. Instead of
dd/mm/yyyy we need yyyy-mm-dd. To do this we can use the
<code>substr</code> function along with the <code>||</code> operator
which is used to concatenate strings together.</p>
<p>We can extract individual parts of the date like this;</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="kw">as</span> <span class="dt">year</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">month</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">day</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>;</span></code></pre>
</div>
<p>But in order to convert it into a date we need all three parts
concatenated together along with ‘-’ to separate the parts.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>) <span class="kw">as</span> converted_date</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>;</span></code></pre>
</div>
<p>We can then convert our new string containing the date into a proper
date by passing it to the <code>date</code> function.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>       <span class="dt">date</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>       ) <span class="kw">as</span> converted_date</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>;</span></code></pre>
</div>
<p>We can now use our <code>converted_date</code> column to sort by</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>       <span class="dt">date</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>       ) <span class="kw">as</span> converted_date</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> converted_date</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>;</span></code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Change the query above to sort by the <code>A01_interview_date</code>
field and compare the results</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>       <span class="dt">date</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="op">||</span> <span class="st">'-'</span> <span class="op">||</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>       ) <span class="kw">as</span> converted_date</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> A01_interview_date</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>In the Spreadsheets lesson we discussed that splitting dates into
year, month and day components was a good way of making the meaning of
the date parts unambiguous. Our first SQL query for the date conversion
did this;</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="kw">as</span> <span class="dt">year</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">month</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">day</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>;</span></code></pre>
</div>
<p>Having the date components split in this way does not prevent us from
sorting them. We just need to specify all of the columns we want to sort
by in the order in which we want them sorted.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="kw">as</span> <span class="dt">year</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">month</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">day</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> <span class="dt">year</span>, <span class="dt">month</span>, <span class="dt">day</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>;</span></code></pre>
</div>
<p>By default the <code>ORDER BY</code> clause will sort in ascending
order, smallest to biggest; we can make this explicit by usingthe
<code>ASC</code> keyword. Or if we want to sort in descending order we
can use the <code>DESC</code> keyword.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="kw">SELECT</span> A01_interview_date,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">7</span>,<span class="dv">4</span>) <span class="kw">as</span> <span class="dt">year</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">4</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">month</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>       <span class="fu">substr</span>(A01_interview_date,<span class="dv">1</span>,<span class="dv">2</span>) <span class="kw">as</span> <span class="dt">day</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> <span class="dt">year</span> <span class="kw">DESC</span>, <span class="dt">month</span> <span class="kw">DESC</span>, <span class="dt">day</span> <span class="kw">DESC</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>;</span></code></pre>
</div>
</section><section id="using-sql-syntax-to-conditionally-create-new-values"><h2 class="section-heading">Using SQL syntax to conditionally create new values<a class="anchor" aria-label="anchor" href="#using-sql-syntax-to-conditionally-create-new-values"></a>
</h2>
<hr class="half-width"><p>This format of the case statement allows you to check if various
values <strong>are equal</strong> to the value in the field given after
the <code>CASE</code> keyword.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">Id</span>, country,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>       <span class="cf">CASE</span> country</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>           <span class="cf">WHEN</span> <span class="st">'Moz'</span> <span class="cf">THEN</span> <span class="st">'Mozambique'</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>           <span class="cf">WHEN</span> <span class="st">'Taz'</span> <span class="cf">THEN</span> <span class="st">'Tanzania'</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>       <span class="cf">ELSE</span> <span class="st">'Unknown Country'</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>       <span class="cf">END</span> <span class="kw">AS</span> country_fullname</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>;</span></code></pre>
</div>
<p>There is a more general form which allows to to perform any kind of
test.</p>
</section><section id="using-sql-syntax-to-create-binned-values"><h2 class="section-heading">Using SQL syntax to create ‘binned’ values<a class="anchor" aria-label="anchor" href="#using-sql-syntax-to-create-binned-values"></a>
</h2>
<hr class="half-width"><p>It is often the case that we wish to convert a continuous variable
into a discrete factor type variable.</p>
<p>We can use a <code>CASE</code> statement to create this type of
effect.</p>
<p>The column <code>A11_years_farm</code> in the Farms table is an
indication of how many years the respondent has been on the farm. The
values are in years and range from 1 to 60. Instead of using individual
years we may want to group these values into ranges like 1-10, 11-20
etc. We can do this using a <code>CASE</code> statement as part of the
<code>SELECT</code> clause</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">SQL<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sql" tabindex="0"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">Id</span>, A11_years_farm,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>       <span class="cf">CASE</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>           <span class="cf">WHEN</span>  A11_years_farm <span class="kw">BETWEEN</span> <span class="dv">1</span> <span class="kw">AND</span> <span class="dv">10</span> <span class="cf">THEN</span> <span class="st">'1-10'</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>           <span class="cf">WHEN</span>  A11_years_farm <span class="kw">BETWEEN</span> <span class="dv">11</span> <span class="kw">AND</span> <span class="dv">20</span> <span class="cf">THEN</span> <span class="st">'11-20'</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>           <span class="cf">WHEN</span>  A11_years_farm <span class="kw">BETWEEN</span> <span class="dv">21</span> <span class="kw">AND</span> <span class="dv">30</span> <span class="cf">THEN</span> <span class="st">'21-30'</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>           <span class="cf">WHEN</span>  A11_years_farm <span class="kw">BETWEEN</span> <span class="dv">31</span> <span class="kw">AND</span> <span class="dv">40</span> <span class="cf">THEN</span> <span class="st">'31-40'</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>           <span class="cf">WHEN</span>  A11_years_farm <span class="kw">BETWEEN</span> <span class="dv">41</span> <span class="kw">AND</span> <span class="dv">50</span> <span class="cf">THEN</span> <span class="st">'41-50'</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>           <span class="cf">WHEN</span>  A11_years_farm <span class="kw">BETWEEN</span> <span class="dv">41</span> <span class="kw">AND</span> <span class="dv">50</span> <span class="cf">THEN</span> <span class="st">'51-60'</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>       <span class="cf">ELSE</span> <span class="st">'&gt; 60'</span>       </span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>       <span class="cf">END</span> <span class="kw">AS</span> A11_years_farm_range</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="kw">FROM</span> Farms</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>;</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>New result columns can be created using arithmetic operators or
built-in functions</li>
<li>New columns have to be given names or aliases</li>
<li>The <code>CASE</code> coding structure can be used to create new
columns</li>
<li>The new columns are only in the query results. The original table is
not changed</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="04-missing-data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="06-aggregation.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="04-missing-data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Missing Data
        </a>
        <a class="chapter-link float-end" href="06-aggregation.html" rel="next">
          Next: Aggregations... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/sql-socialsci/edit/main/episodes/05-creating-new-columns.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/sql-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/sql-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/sql-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/sql-socialsci/05-creating-new-columns.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Creating New Columns",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/sql-socialsci/05-creating-new-columns.html",
  "identifier": "https://datacarpentry.github.io/sql-socialsci/05-creating-new-columns.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2023-05-02",
  "datePublished": "2024-07-02"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

